var ft_seat_minimap_timer_idx,ft_seat_minimap_dragging=!1,ft_seat_minimap_mouse_position={mx:0,my:0,lx:0,ly:0},userSelect_info=$.cgv.data.고객선택정보,userSelect_info_seat=null,userSelect_info_theater_cd=null,userSelect_info_cinema_cd=null,userSelect_info_cinema_rate=null,userSelect_info_cinema_rate_ex=["11","15","02","09","04"],isNonOddTheater=!1,isEventMovieCD=!1,isSeniorNotice=!1,isPreferenceNotice=!1,createBoolStep2=!1,seatGuideArr=[];function createOnceStep2(){createBoolStep2=!0;var s=$('<span class="radiobutton"></span>'),i=$("div.theater_minimap div.seat-type");i.find("span.type-prime").remove(),i.parents("div.legend").css({width:"125px"});var e=[{ratingNM:"rating_prime",titleNM:"Prime 석",seatNM:"Prime Zone"},{ratingNM:"rating_comfort",titleNM:"Standard 석",seatNM:"Standard Zone"},{ratingNM:"rating_economy",titleNM:"Light 석",seatNM:"Light Zone"},{ratingNM:"eggbox",titleNM:"EGG BOX",seatNM:"EGG BOX"},{ratingNM:"recliner",titleNM:"Recliner",seatNM:"Recliner"},{ratingNM:"cabana",titleNM:"카바나 석",seatNM:IS_ENGLISH?"Cabana":"카바나석"},{ratingNM:"beanbag",titleNM:"빈백 석",seatNM:IS_ENGLISH?"Beanbag":"빈백석"},{ratingNM:"mat",titleNM:"매트 석",seatNM:IS_ENGLISH?"Mat":"매트석"},{ratingNM:"premium",titleNM:"프리미엄 석",seatNM:IS_ENGLISH?"Premium":"프리미엄석"},{ratingNM:"relax",titleNM:"릴렉스 석",seatNM:IS_ENGLISH?"Relax":"릴렉스석"},{ratingNM:"comport",titleNM:"컴포트 석",seatNM:IS_ENGLISH?"Comport":"컴포트석"},{ratingNM:"mybox",titleNM:"My box 석",seatNM:IS_ENGLISH?"My Box":"MYBOX"},{ratingNM:"cdcSofa",titleNM:"쇼파 석",seatNM:IS_ENGLISH?"Sofa":"소파"},{ratingNM:"cdcRecliner",titleNM:"리클라이너 석",seatNM:IS_ENGLISH?"Recliner":"리클라이너"},{ratingNM:"coupleSofa",titleNM:"Couple 쇼파 석",seatNM:IS_ENGLISH?"Couple Sofa":"커플소파"},{ratingNM:"vibration",titleNM:"진동 석",seatNM:IS_ENGLISH?"vibartion":"진동석"},{ratingNM:"suite_A",titleNM:"Suite A 석",seatNM:"Suite A"},{ratingNM:"suite_B",titleNM:"Suite B 석",seatNM:"Suite B"},{ratingNM:"familyRecliner",titleNM:"패밀리 리클라이너 석",seatNM:IS_ENGLISH?"Family Recliner":"패밀리 리클라이너"}];$.each(e,function(e,t){var a=s.clone();a.addClass("type-"+t.ratingNM).text(t.seatNM).attr("title",t.titleNM).append($('<span class="icon"/>')),a.css({display:"none"}),0===e||1===e||2===e?i.prepend(a):i.append(a)});var t,a=null,n={},o=$("#skip_seat_list");o=$("div.section-numberofpeople"),n.title="관람 할인 안내",n.popTitle="할인 안내",n.popTitle1="경로우대",n.popTitle2="국가유공자할인",n.popTitle3="장애우대할인",n.popTitle4="심야할인",n.popTitle5="청소년 할인",n.popDisc1="만 65세 이상을 증명할 수 있는 신분증 제시",n.popDisc2="국가 유공자증 소지자 본인에 한함",n.popDisc3="현장에서 복지카드를 소지한 장애인<br/>(장애 1~3등급: 동반 1인까지 적용 / 4~6등급: 본인에 한함 / <br/>일반 2D, 3D, 4DX 영화에 한함)",n.popDisc4="극장별 심야할인 이벤트는 각 극장에 문의",n.popDisc5="만 18세 미만을 증명할수 있는 신분증 제시<br/>(만 4세 이상 ~ 만 18세 미만의 학생 또는 청소년(어린이)에<br/>한함)",a=$('<a href="javascript:void(0)" id="reservarionDiscountInfo">'+n.title+"</a>"),t='<div style="margin-bottom: 40px;">\t\t<h3>'+n.popTitle+'</h3>\t\t<table style="margin: 10px 0; border-top:1px solid #999; width: 100%;">\t\t\t<colgroup>\t\t\t\t<col width="120" align="left" valign="middle"></col>\t\t\t\t<col width="*"></col>\t\t\t</colgroup>\t\t\t<tbody>\t\t\t\t<tr>\t\t\t\t\t<th style="text-align: left; padding-left: 5px; border-bottom: 1px solid #bbb; border-right: 1px solid #bbb;">'+n.popTitle3+'</th>\t\t\t\t\t<td style="text-align: left; border-bottom: 1px solid #bbb; padding-left: 10px;">'+n.popDisc3+'</th>\t\t\t\t</tr>\t\t\t\t<tr>\t\t\t\t\t<th style="text-align: left; padding-left: 5px; border-bottom: 1px solid #bbb; border-right: 1px solid #bbb;">'+n.popTitle4+'</th>\t\t\t\t\t<td style="text-align: left; border-bottom: 1px solid #bbb; padding-left: 10px;">'+n.popDisc4+'</th>\t\t\t\t</tr>\t\t\t\t<tr>\t\t\t\t\t<th style="text-align: left; padding-left: 5px; border-bottom: 1px solid #bbb; border-right: 1px solid #bbb;">'+n.popTitle5+'</th>\t\t\t\t\t<td style="text-align: left; border-bottom: 1px solid #bbb; padding-left: 10px;">'+n.popDisc5+"</th>\t\t\t\t</tr>\t\t\t</tbody>\t\t</table></div>",a.unbind("click").bind("click",function(){ticketAlert(n.title,t,"nonConfirm")}),IS_ENGLISH||o.append(a)}function drawSelectScreenInfo(){var e=$(".step1 .section-time .time-list li.selected"),t=e.data("screen"),a=t.PLAY_YMD;playDate=a.substr(0,4)+"."+a.substr(4,2)+"."+a.substr(6,2);var s=parseInt(a.substr(0,4),10),i=parseInt(a.substr(4,2)-1,10),n=parseInt(a.substr(6,2),10),o=new Date(s,i,n);playDays=IS_ENGLISH?["Sun","Mon","Tue","Wed","Thur","Fri","Sat"]:["일","월","화","수","목","금","토"];var r={};r.play_date=playDate,r.play_day=playDays[o.getDay()],r.time_start=t.PLAY_START_TM.substr(0,2)+":"+t.PLAY_START_TM.substr(2,2),r.time_end=t.PLAY_END_TM.substr(0,2)+":"+t.PLAY_END_TM.substr(2,2);var c={};c.remain=e.data("remain_seat"),c.total=t.SEAT_CAPACITY;var l={};l.body=$("#user-select-info"),l.site=l.body.find("span.site"),l.screen=l.body.find("span.screen"),l.seatNum=l.body.find("span.seatNum"),l.playYMD=l.body.find("p.playYMD-info"),l.site.text(t.THEATER_NM),l.screen.text(t.SCREEN_NM),l.seatNum.find(".restNum").text(c.remain),l.seatNum.find(".totalNum").text(c.total),l.playYMD.find("b:eq(0)").text(r.play_date),l.playYMD.find("b:eq(1)").text("("+r.play_day+")"),l.playYMD.find("b:eq(2)").text(r.time_start+" ~ "+r.time_end)}function ticketStep2Init(){createBoolStep2||createOnceStep2(),userSelect_info_seat=userSelect_info.좌석,userSelect_info_theater_cd=userSelect_info.극장.극장코드,userSelect_info_cinema_cd=userSelect_info.상영관시간.상영관코드,userSelect_info_cinema_rate=userSelect_info.상영관시간.상영관등급코드,isPreferenceNotice=isSeniorNotice=isEventMovieCD=isNonOddTheater=!1,kidsFamily.init(),noblessesClub.init(),"15"===userSelect_info_cinema_rate&&"0205"===userSelect_info.극장.극장코드&&(isNonOddTheater=!0),"0228"===userSelect_info.극장.극장코드&&(isNonOddTheater=!0),userSelect_info.영화.영화코드===eventMovieCD&&(isEventMovieCD=!0),updateNanoScroller($("#seat_minimap_nano")),ftSetSeatLayoutZoom(!1),drawSelectScreenInfo(),ftLoadSeatLayout(),ticketStep2PopupCheck(),setTimeout(function(){skipToSomething("skip_seat_list")},0)}function onTicketStep2Prev(){$("#seats_list .row .seat").removeClass("selected preselect"),ft_selected_seat_rating="",ticketPopupHideAll(),loadPrereservateSeatsCancel(function(){ticketStep2Update(),ftResetAllSeats(!0),$.cgv.data.예매확정정보.초기화()})}function ticketStep2Update(){userSelect_info_seat.군인인원수=0,userSelect_info_seat.일반인원수=0,userSelect_info_seat.학생인원수=0,userSelect_info_seat.어린이인원수=0,userSelect_info_seat.경로인원수=0,userSelect_info_seat.우대인원수=0,settingNOPSection(),ftMarkNotAvailSeats(),tnbUpdate()}function settingNOPSection(){selectNumData.millitary=userSelect_info_seat.군인인원수,selectNumData.adult=userSelect_info_seat.일반인원수,selectNumData.youth=userSelect_info_seat.학생인원수,selectNumData.child=userSelect_info_seat.어린이인원수,selectNumData.senior=userSelect_info_seat.경로인원수,selectNumData.special=userSelect_info_seat.우대인원수;var e=$(".steps .step2 .section.section-seat"),t=$(".section-numberofpeople .numberofpeople-select .group");t.hide(),$("li",t).unbind("click").bind("click",numPeopleClickListener).removeClass("selected");var a=t.eq(0).find("li").attr("type","millitary");personNum_li_adult=t.eq(1).find("li").attr("type","adult"),personNum_li_youth=t.eq(2).find("li").attr("type","youth"),personNum_li_child=t.eq(3).find("li").attr("type","child"),personNum_li_senior=t.eq(4).find("li").attr("type","senior"),personNum_li_special=t.eq(5).find("li").attr("type","special"),a.eq(selectNumData.millitary).addClass("selected"),personNum_li_adult.eq(selectNumData.adult).addClass("selected"),personNum_li_youth.eq(selectNumData.youth).addClass("selected"),personNum_li_child.eq(selectNumData.child).addClass("selected"),personNum_li_senior.eq(selectNumData.senior).addClass("selected"),personNum_li_special.eq(selectNumData.special).addClass("selected");var s=!1,i=$.cgv.data.SEAT_INFO.PRICE_INFO;if(void 0===i)return!1;for(var n=$.isArray(i)?i:[i],o=0;o<n.length;++o){var r=n[o];"01"==r.TICKET_TYPE&&0<parseInt(r.TICKET_TYPE,10)&&t.eq(1).show(),"04"==r.TICKET_TYPE&&0<parseInt(r.TICKET_TYPE,10)&&t.eq(4).show(),screen_YMD<senior_YMD?t.eq(4).find(".title").text(IS_ENGLISH?"Preference":"우대"):(t.eq(4).find(".title").text(IS_ENGLISH?"Senior":"경로"),"03"==r.TICKET_TYPE&&0<parseInt(r.TICKET_TYPE,10)&&t.eq(5).show()),"05"==r.TICKET_TYPE&&0<parseInt(r.TICKET_TYPE,10)&&t.eq(3).show(),"02"==r.TICKET_TYPE&&0<parseInt(r.TICKET_TYPE,10)&&(kidsFamily.cineKids()&&t.eq(1).hide(),kidsFamily.cineKids()?t.eq(2).hide():t.eq(2).show()),"10"==r.TICKET_TYPE&&0<parseInt(r.TICKET_TYPE,10)&&(s=!0)}"99"===$.cgv.data.고객선택정보.영화.영화등급코드&&(t.eq(2).hide(),t.eq(3).hide()),"Y"===$.cgv.data.통신.복호화($.cgv.data.고객정보.군인여부)&&s&&!selectedMovieInfo.isBool("package")&&t.eq(0).show(),numPeopleDimm(),e.removeClass("three_line").removeClass("four_line");var c=$("div.group:visible").length;3==c&&e.addClass("three_line"),4==c&&e.addClass("four_line"),ft_person_count=selectNumData.total(),ft_seat_remain_count=ft_person_count,ft_seat_select_count=0,ts2ValidatePersonCount(),ftSetAdjacentSeatSelector(ft_person_count)}function ts2ValidatePersonCount(){var e=$("#ticket .section-seat"),t=selectNumData.total();0!=t&&ticketStep2PeopleCountCheck(t)?e.removeClass("dimmed"):e.addClass("dimmed")}function numPeopleClickListener(e){if(!(0<getLoadingCount())){_showLoadingIE();var t=$(e.currentTarget?e.currentTarget:e.srcElement);if("dimmed"===t.attr("class"))return!1;var a=t.attr("type");if("child"===a){if(0===parseInt(t.data("count")))return numPeopleClickCallBack(t),!1;kidsFamily.check(function(e){"Y"===e&&numPeopleClickCallBack(t),"N"===e&&kidsFamily.join()})}else"adult"===a&&noblessesClub.is("target")?noblessesClub.is("join")?numPeopleClickCallBack(t):noblessesClub.join():numPeopleClickCallBack(t)}}function numPeopleClickCallBack(e){var t=e.attr("type"),a=0;if(e.parents(".numberofpeople-select").find("li.selected").each(function(){$(this).attr("type")==t?a+=e.data("count"):a+=$(this).data("count")}),"millitary"!==t&&0<selectNumData.millitary||"millitary"===t&&0<selectNumData.total()-selectNumData.millitary)ticketAlert("인원선택 제한","군인 발권의 경우,<br/><em>타 권종과 복합 예매가 불가합니다. </em><br/><br/>구매일 기준 일 2회 동반 3인까지 군인 할인 가격으로 구매 가능합니다.");else if(0<a&&"millitary"===t&&ticketAlert("군인관람안내","군인 발권의 경우,<br/>구매일 기준 일 2회 동반 3인까지 군인 할인 가격으로 구매 가능합니다.<br/><br/>군인 확인증을 꼭 지참해주세요. 상영관 입장 시 군인 확인증 미지참한 경우 입장이 제한될 수 있습니다.<br/><br/>* 군인할인을 적용하여 구매 시 이벤트 또는 중복할인이 적용되지 않습니다."),a<ft_seat_select_count)alert("선택한 좌석이 예매 인원 보다 많습니다.");else{if(a>MAX_RESERVATION_COUNT){if(IS_ENGLISH)return alert(MSG1_MAX_PEOPLE1+MAX_RESERVATION_COUNT+MSG1_MAX_PEOPLE2),void _hideLoadingIE();var s="최대인원선택",i="<em>특별 방역지침 강화에 따라 예매 가능 수량이 4매로 제한됩니다.</em><br/>좌석 간 띄어앉기 및 상영관 내 마스크 상시 착용 부탁드립니다.<br/>",n="확인",o=$("#fullResInfoCon"),r=$("#blackscreen"),c=$("#ticket_loading");return 0==o.length&&(o=$('<div id="fullResInfoCon" class="ft_layer_popup"/>'),popNotiConHtml='\t<div class="hd">\t\t<div class="title_area"><h4>'+s+'</h4></div>\t</div>\t<div class="bd">\t\t<div class="bd_txt" style="margin-bottom: 15px; text-align: center">'+i+'</div>\t\t<div style="text-align: center;">\t\t\t<a title="확인" class="closePop btn btn_red btn_size3" style="width: 115px" onclick="return false;" href="#"><span>'+n+'</span></a>\t\t</div>\t</div>\t<a title="창 닫기" class="pop_close closePop" onclick="return false;" href="#none">닫기</a>',o.append(popNotiConHtml).css({position:"absolute",display:"block",width:"450px",height:"210px",left:"55%",top:"35%"}),o.find("a.closePop").click(function(){o.hide(),r.hide()}),$("body").append(o)),r.show(),c.hide(),void o.show()}if(("child"===t||"senior"===t||"special"===t)&&"02"===ft_selected_seat_rating)return alert(MSG1_PREFERENTIAL_ALERT_MSG),!1;if("millitary"==t&&(selectNumData.millitary=parseInt(e.data("count"))),"adult"==t&&(selectNumData.adult=parseInt(e.data("count"))),"youth"==t&&(selectNumData.youth=parseInt(e.data("count"))),"senior"==t&&(selectNumData.senior=parseInt(e.data("count"))),"special"==t&&(selectNumData.special=parseInt(e.data("count"))),"child"==t&&(kidsFamily.is()?selectNumData.child=parseInt(e.data("count")):selectNumData.youth=parseInt(e.data("count")),kidsFamily.is()&&0===parseInt(e.data("count"))&&(selectNumData.child=0)),numTotalPerson=selectNumData.total(),4<numTotalPerson&&"0150"==$.cgv.data.고객선택정보.극장.극장코드&&-1!=$.cgv.data.고객선택정보.영화.영화명.indexOf("무료"))return ticketAlert(MSG1_FREE_TICKET_MAX4_t,MSG1_FREE_TICKET_MAX4_c),void _hideLoadingIE();screen_YMD<senior_YMD?"senior"!==t||isPreferenceNotice||(isPreferenceNotice=!0,ticketAlert(MSG1_PREFERENTIAL_PRICING_t,MSG1_PREFERENTIAL_PRICING_c)):("senior"!==t||isSeniorNotice||(isSeniorNotice=!0,ticketAlert(MSG1_SENIOR_PRICING_t,MSG1_SENIOR_PRICING_c)),"special"!==t||isPreferenceNotice||(isPreferenceNotice=!0,ticketAlert(MSG1_PREFERENTIAL_PRICING_t,MSG1_PREFERENTIAL_PRICING_c2))),e.parent().find("li").removeClass("selected"),e.addClass("selected");var l=$.cgv.data.고객선택정보.좌석;l["군인인원수"]=selectNumData.millitary,l["일반인원수"]=selectNumData.adult,l["학생인원수"]=selectNumData.youth,l["어린이인원수"]=selectNumData.child,l["경로인원수"]=selectNumData.senior,l["우대인원수"]=selectNumData.special,numPeopleDimm(),numPeopleClickProcess()}}function numPeopleDimm(){var e=$(".section-numberofpeople .numberofpeople-select .group");$("li",e).removeClass("dimmed");for(var t=MAX_RESERVATION_COUNT-selectNumData.total(),a=["millitary","adult","youth","child","senior","special"],s=0;s<a.length;s++){var i=$("#nop_group_"+a[s]),n=$("li",i),o=selectNumData[a[s]]+t;n.each(function(){parseInt($(this).attr("data-count"),10)>o&&$(this).addClass("dimmed")})}}function numPeopleClickProcess(){ftUpdateSeatCounting(),ts2ValidatePersonCount(),ftResetAdjacentSeatSelector(),ts2RestrictAdjacentSeat(),setTimeout("numPeopleClickProcessDelay()",0)}function numPeopleClickProcessDelay(){ts2ResetSeatLayout(),_hideLoadingIE()}function ts2SeatZoomClickListener(){var e=$("#seat_zoom_btn");e.toggleClass("on"),e.hasClass("on")?(ftSetSeatLayoutZoom(!0),IS_ENGLISH?e.html("Reduce"):e.html("작게보기"),logClick("크게보기")):(ftSetSeatLayoutZoom(!1),IS_ENGLISH?e.html("Enlarge"):e.html("크게보기"),logClick("작게보기")),updateNanoScroller($("#seat_minimap_nano"))}function ts2RestrictAdjacentSeat(){}var allSeatRowCon=$("#seats_list .row .seat");function ts2ResetSeatLayout(){allSeatRowCon.removeClass("selected preselect"),ftSetAdjacentSeatSelector(ft_seat_remain_count),ftChooseSeatGroupDirection(),ftResetSeatGrouping(),tnbUpdate()}var textLoopEvt=null;function theaterNoticeChecker(){null!==textLoopEvt&&clearInterval(textLoopEvt);var a=$("#theaterNoticeInfoCon");if(1<=a.length&&a.remove(),"object"==typeof $.cgv.data.SEAT_INFO.MVE_INFO){var e=$.cgv.data.SEAT_INFO.MVE_INFO.MVE_ADD_INFO;if(""===e)return;var s=$("p.textCon",a);function t(){var e=a.width(),t=s.width();s.css("margin-left",e).stop(!0,!1).animate({"margin-left":-t},11e3,"linear")}a.length<=0&&((a=$('<div id="theaterNoticeInfoCon"/>')).css({width:"520px",height:"15px",padding:"5px",overflow:"hidden",background:"#333",position:"absolute",bottom:"0px",left:"150px"}),(s=$('<span class="textCon"/>')).css({position:"relative",display:"inline-block",color:"#ddd","white-space":"noWrap"}),a.append(s),$("div#seat_minimap_nano").append(a)),s.text(e),t(),textLoopEvt=setInterval(function(){t()},11e3)}}function ticketDrawTheater(){clearInterval(ft_seat_minimap_timer_idx);var e=$("#seat_minimap_nano"),t=$("#minimap"),a=(e.find(".content"),e.find(".screen")),s=e.find(".seats"),i=$.cgv.data.SEAT_INFO.SCREEN_INFO,n=$.cgv.data.SEAT_INFO.PRICE_INFO,o=$.cgv.data.SEAT_INFO.SEAT_INFO,r=($.cgv.data.SEAT_INFO.TICKET_INFO,$.cgv.data.SEAT_INFO.SCREEN_GATE_INFO,$.cgv.data.SEAT_INFO.SEAT_NOTICE_INFO);$.cgv.data.고객선택정보;if(ft_selected_seat_rating="",FIRST_ALLEY_X=[],seatGuideArr=[],null==o)return alert(MSG2_NO_SEAT_DATA),ticketRestart(),!1;if(i.length<=0)return alert(MSG2_RESERVATION_NOT_READY),!1;var c=e.hasClass("zoom"),l=parseInt(i.X_CNT,10),d=parseInt(i.Y_CNT,10);t.hide(),s.css("margin-top","").empty();var _=16*(l+1),p=16*d,u=24*(l+1),f=24*d,m=_;m<652&&(m=652),a.css("width",m),c&&(_=u,p=f),s.css({width:_+"px",height:p+"px"}),s.data("width",_),s.data("height",p),s.data("width_zoom",u),s.data("height_zoom",f);for(var S,v,N,h,I,g=o,C=n,E=r,T=$("<div></div>"),A=g.length,b=0;b<A;b++){var M,R,D=g[b],G=parseInt(D.LOC_X,10),L=parseInt(D.LOC_Y,10),P=parseInt(D.SEAT_NO,10),y=D.SEAT_STATE;v!=L&&(!0,FIRST_ALLEY_X[L-1]=-1,h="<div class='row' style='top:",h+=c?24*(L-1):16*(L-1),h+="px;'>",h+="<div class='label'>"+D.LOC_Y_NM+"</div>",IS_ENGLISH?h+="<a href='#' onclick='skipToNextRow(event);return false;' class='skip_row'>skip row "+D.LOC_Y_NM+"</a>":h+="<a href='#' onclick='skipToNextRow(event);return false;' class='skip_row'>"+D.LOC_Y_NM+"열 건너뛰기</a>",h+="</div>",(M=$(h)).data("top",16*(L-1)),M.data("top_zoom",24*(L-1)),T.append(M)),-1==FIRST_ALLEY_X[L-1]&&1<G-S&&(FIRST_ALLEY_X[L-1]=G-1),(v!=L||1<G-S)&&(N=$("<div class='seat_group'></div>"),M.append(N)),S=G,v=L;var O=!1,k=!1,x=!1,w=!1,Y=!1,H=!1,F=!1,j=!1,V=!1,U=!1,B=!1,q=!1,X=!1,K=!1;"Y"!==y&&(O=!0),O||(x=!0),"02"===D.KIND_CD&&(k=!0),"N"===y&&"03"===D.KIND_CD&&(K=!0);var z=D.RATING_CD;"02"===z&&(w=!0),"03"===z&&(Y=!0),"04"===z&&(F=!0),"08"===z&&(H=!0),"09"===z&&(q=!0),"10"===z&&(j=!0),"11"===z&&(V=!0),"12"!==z&&"13"!==z&&"14"!==z||(U=!0),"16"===z&&(B=!0),"19"===z&&(X=!0),k&&(z="sp"),0!=seatGuideArr.length&&-1!=seatGuideArr.indexOf(z)||seatGuideArr.push(z);var J='<div class="seat';if(K&&("99"!==DISTANCE_CLS?J+=" distanced":J+=" blocked"),O?J+=" reserved":k?J+=" handicap":(w&&(J+=" sweet"),Y&&(J+=" veat"),H&&(J+=" cinekids"),q&&(J+=" premium"),F&&(J+=" fourd"),j&&(J+=" wide"),V&&(J+=" couple"),B&&(J+=" eggbox"),X&&(J+=" recliner"),"06"===D.RATING_CD&&(J+=" vibration"),"20"===D.RATING_CD&&(J+=" cabana"),"21"===D.RATING_CD&&(J+=" beanbag"),"22"===D.RATING_CD&&(J+=" mat"),"23"===D.RATING_CD&&(J+=" relax"),"24"===D.RATING_CD&&(J+=" comport"),"25"===D.RATING_CD&&(J+=" mybox"),"26"===D.RATING_CD&&(J+=" coupleSofa"),"27"===D.RATING_CD&&(J+=" cdcRecliner"),"28"===D.RATING_CD&&(J+=" cdcSofa"),"29"===D.RATING_CD&&(J+=" comport"),"30"===D.RATING_CD&&(J+=" coupleSofa"),"31"===D.RATING_CD&&(J+=" suite_A"),"32"===D.RATING_CD&&(J+=" suite_B"),"33"===D.RATING_CD&&(J+=" familyRecliner"),U&&("12"===D.RATING_CD&&(J+=" rating_prime"),"13"===D.RATING_CD&&(J+=" rating_comfort"),"14"===D.RATING_CD&&(J+=" rating_economy"))),J+='"',J+=' style="left:',J+=c?24*G+'px"':16*G+'px"',J+=' data-left="'+16*G+'"',J+=' data-left_zoom="'+24*G+'">',J+='<a href="#"" onclick="return false;""><span class="no">',J+=P,J+='</span><span class="sreader">',O&&(J+=IS_ENGLISH?" occupied seat":" 예매완료"),k&&(J+=IS_ENGLISH?" handicapped seat":" 장애인석"),w&&(J+=(IS_ENGLISH," sweetbox")),Y&&(J+=(IS_ENGLISH," veatbox")),H&&(J+=(IS_ENGLISH," cinekids")),q&&(J+=IS_ENGLISH?" premium":" 프리미엄석"),F&&(J+=(IS_ENGLISH," 4dx")),j&&(J+=(IS_ENGLISH," widebox")),V&&(J+=IS_ENGLISH?" coupled seat":" 커플석"),B&&(J+=IS_ENGLISH?" Egg box seat":" Egg Box"),X&&(J+=IS_ENGLISH?" Recliner seat":" 리클라이너석"),"06"===D.RATING_CD&&(J+=IS_ENGLISH?"vibration":"진동석"),"23"===D.RATING_CD&&(J+=IS_ENGLISH?"Relax":"릴렉스석"),"24"===D.RATING_CD&&(J+=IS_ENGLISH?"Comport":"컴포트석"),"25"===D.RATING_CD&&(J+=IS_ENGLISH?"My box":"마이박스석"),"26"===D.RATING_CD&&(J+=IS_ENGLISH?"Couple sofa":"커플쇼파석"),"27"===D.RATING_CD&&(J+=IS_ENGLISH?"Recliner seat":"리클라이너석"),"28"===D.RATING_CD&&(J+=IS_ENGLISH?"Sofa seat":"쇼파석"),"29"===D.RATING_CD&&(J+=IS_ENGLISH?"Comport":"컴포트석"),"31"===D.RATING_CD&&(J+="Suite A"),"32"===D.RATING_CD&&(J+="Suite B"),"33"===D.RATING_CD&&(J+=IS_ENGLISH?"Family Recliner":"패밀리 리클라이너"),"01"==D.SEAT_AREA_CD&&(J+=(IS_ENGLISH," prime zone")),U&&("12"===D.RATING_CD&&(J+=IS_ENGLISH?" prime seat":" Prime"),"13"===D.RATING_CD&&(J+=IS_ENGLISH?" comfort seat":" Comfort"),"14"===D.RATING_CD&&(J+=IS_ENGLISH?" Light seat":" Light")),J+="</span><span class='sreader mod'></span></a></div>",(R=$(J)).data("xml",D),N.append(R),(I=R.find("a")).bind("click",ftSeatClickListener),I.bind("focus blur",ftSeatFocusListener),I.bind("mouseenter",ftSeatMouseEnterListener),I.bind("mouseleave",ftSeatMouseLeaveListener),!IS_ENGLISH&&null!=E)for(var Z=E.length,W=0;W<Z;W++){var Q=$.cgv.data.SEAT_INFO.SEAT_NOTICE_INFO[W];if(D.SEAT_LOC_NO==Q.SEAT_LOC_NO){R.data("seat_desc",Q.SEAT_EACH_INFO),R.attr("title",Q.SEAT_EACH_INFO);break}}0,x&&0;var ee=C.length;for(W=0;W<ee;W++){var te=R.data("xml").RATING_CD,ae=C[W];if(te==ae.RATING_CD){var se=R.data("가격정보");null==se&&(se=new Array),se.push(ae),R.data("가격정보",se)}"01"==$.cgv.data.고객선택정보.상영관시간.상영시간코드&&"01"==ae.TICKET_TYPE&&0<parseInt(ae.PRICE,10)?ae.PRICE:"01"==$.cgv.data.고객선택정보.상영관시간.상영시간코드&&"02"==ae.TICKET_TYPE&&0<parseInt(ae.PRICE,10)&&ae.PRICE}}s.append(T),ftChooseSeatGroupDirection(),ftResetSeatGrouping(),setTimeout("ticketDrawTheaterDelay()",0)}function ticketDrawTheaterDelay(){$(".section-seat .theater.nano").nanoScroller(),ftDrawMinimap(),ftDrawExits(),ftShowSeatExam()}function ftShowSeatExam(){var e=$("div.theater_minimap div.seat-type");e.find("span.radiobutton").hide();for(var t="type-",a=0;a<seatGuideArr.length;++a){var s=null;"sp"===seatGuideArr[a]&&(s=t+"handicap"),"01"===seatGuideArr[a]&&(s=t+"normal"),"02"===seatGuideArr[a]&&(s=t+"sweetbox"),"03"===seatGuideArr[a]&&(s=t+"veatbox"),"04"===seatGuideArr[a]&&(s=t+"4d"),"06"===seatGuideArr[a]&&(s=t+"vibration"),"08"===seatGuideArr[a]&&(s=t+"cinekids"),"09"===seatGuideArr[a]&&(s=t+"premium"),"10"===seatGuideArr[a]&&(s=t+"widebox"),"11"===seatGuideArr[a]&&(s=t+"couple"),"12"===seatGuideArr[a]&&(s=t+"rating_prime"),"13"===seatGuideArr[a]&&(s=t+"rating_comfort"),"14"===seatGuideArr[a]&&(s=t+"rating_economy"),"16"===seatGuideArr[a]&&(s=t+"eggbox"),"19"===seatGuideArr[a]&&(s=t+"recliner"),"20"===seatGuideArr[a]&&(s=t+"cabana"),"21"===seatGuideArr[a]&&(s=t+"beanbag"),"22"===seatGuideArr[a]&&(s=t+"mat"),"23"===seatGuideArr[a]&&(s=t+"relax"),"24"===seatGuideArr[a]&&(s=t+"comport"),"25"===seatGuideArr[a]&&(s=t+"mybox"),"26"===seatGuideArr[a]&&(s=t+"coupleSofa"),"27"===seatGuideArr[a]&&(s=t+"cdcRecliner"),"28"===seatGuideArr[a]&&(s=t+"cdcSofa"),"29"===seatGuideArr[a]&&(s=t+"comport"),"30"===seatGuideArr[a]&&(s=t+"coupleSofa"),"31"===seatGuideArr[a]&&(s=t+"suite_A"),"32"===seatGuideArr[a]&&(s=t+"suite_B"),"33"===seatGuideArr[a]&&(s=t+"familyRecliner"),null!=s&&e.find("span."+s).show()}}function ftDrawExits(){var e=$(".section-seat .theater"),t=$("#seats_list"),a=$("#minimap .mini_container .mini_exits");a.empty();for(var s,i,n=$.cgv.data.SEAT_INFO.SCREEN_INFO,o=$.cgv.data.SEAT_INFO.SCREEN_GATE_INFO,r=parseInt(n.Y_CNT,10),c=parseInt(n.X_CNT,10),l=e.hasClass("zoom"),d=16*(c+1),_=16*r,p=24*(c+1),u=24*r,f=null,m=0,S=0,v=0,N=0,h=[o.GATE_INFO1,o.GATE_INFO2,o.GATE_INFO3],I=h.length,g=0;g<I;g++)if("00"!=(i=h[g])){switch(s=$("<div class='mini_exit'></div>"),f=$("<div class='exit'></div>"),N=v=S=m=0,i){case"01":m=_+10,S=d-30,v=u+10,N=p-30,f.addClass("bottom"),s.addClass("br");break;case"02":m=_+10,v=u+10,N=S=30,f.addClass("bottom"),s.addClass("bl");break;case"03":S=d-30,v=m=-30,N=p-30,f.addClass("top"),s.addClass("tr");break;case"04":m=-30,v=-(S=30),N=30,f.addClass("top"),s.addClass("tl");break;case"05":m=Math.round(_/2),S=d+10,v=Math.round(u/2),N=p+10,f.addClass("right"),s.addClass("cr");break;case"06":m=Math.round(_/2),S=-30,v=Math.round(u/2),N=-30,f.addClass("left"),s.addClass("cl")}l?(f.css("top",v+"px"),f.css("left",N+"px")):(f.css("top",m+"px"),f.css("left",S+"px")),f.data("top",m),f.data("left",S),f.data("top_zoom",v),f.data("left_zoom",N),t.append(f),a.append(s)}}function ftDrawMinimap(){var e=$("#minimap .mini_container"),t=$("#minimap .mini_container .mini_seats");t.empty();var a=$.cgv.data.SEAT_INFO.SCREEN_INFO,s=parseInt(a.Y_CNT,10),i=parseInt(a.X_CNT,10);e.css({width:4*i+30+"px",height:4*s+40+"px"}),CMN_OSBR.ie7&&$("#minimap .mini_header").css("width",4*i+30+"px");for(var n,o,r=$.cgv.data.SEAT_INFO.SEAT_INFO,c=r.length,l=0;l<c;l++){var d=r[l],_=parseInt(d.LOC_X,10),p=parseInt(d.LOC_Y,10),u=!1,f=!1,m=!1,S=!1,v=!1,N=!1,h=!1,I=!1;switch("Y"!=d.SEAT_STATE&&(u=!0),"02"==d.KIND_CD&&(f=!0),d.RATING_CD){case"01":case"05":case"06":case"07":case"08":default:u||!0;break;case"02":m=!0;break;case"03":S=!0;break;case"04":v=!0;break;case"09":I=!0;break;case"10":N=!0;break;case"11":h=!0}o='<div class="mini_seat',u&&(o+=" reserved"),f&&(o+=" handicap"),m&&(o+=" sweet"),S&&(o+=" veat"),v&&(o+=" fourd"),N&&(o+=" wide"),h&&(o+=" couple"),I&&(o+=" premium"),o+='" style="',o+="left:"+4*(_-1)+"px;",o+="top:"+4*(p-1)+"px;",o+='"><span></span></div>',n=$(o),t.append(n)}clearInterval(ft_seat_minimap_timer_idx),ft_seat_minimap_timer_idx=setInterval("ftSeatMinimapTimerListener();",100),$("#minimap .mini_region").unbind("mousedown").bind("mousedown",ftSeatMinimapDownListener)}function ftSeatMinimapTimerListener(){ftSeatMinimapScrollListener()}function ftSeatMinimapScrollListener(){if(!ft_seat_minimap_dragging){var e=$(".section-seat .theater"),t=e.find(".content"),a=$("#minimap"),s=$("#minimap .mini_container"),i=$("#minimap .mini_region"),n=t.scrollTop(),o=t.scrollLeft(),r=t.get(0).scrollHeight,c=t.get(0).scrollWidth,l=e.height(),d=e.width(),_=r-l,p=c-d,u=s.height(),f=s.width();r<l&&(r=l);var m=Math.round(l/r*u),S=Math.round(d/c*f),v=u-m,N=f-S,h=Math.round(n/_*v)+25,I=Math.round(o/p*N)+5;isNaN(h)&&(h=25),isNaN(I)&&(I=5),i.height(m),i.width(S),i.css("top",h),i.css("left",I),l<r||d<c?a.css("display","block"):a.css("display","none")}}function ftSeatMinimapToggle(){var e=$("#minimap");e.hasClass("opened")?e.removeClass("opened"):e.addClass("opened"),ftSeatMinimapScrollListener()}function ftSeatMinimapDownListener(e){var t=$("#minimap .mini_region");e.preventDefault(),ft_seat_minimap_dragging=!0,$(document).unbind("mouseup",ftSeatMinimapUpListener).bind("mouseup",ftSeatMinimapUpListener),$(document).unbind("mousemove",ftSeatMinimapMoveListener).bind("mousemove",ftSeatMinimapMoveListener),ft_seat_minimap_mouse_position.mx=e.pageX,ft_seat_minimap_mouse_position.my=e.pageY,ft_seat_minimap_mouse_position.lx=parseInt(t.css("left"),10),ft_seat_minimap_mouse_position.ly=parseInt(t.css("top"),10)}function ftSeatMinimapMoveListener(e){e.preventDefault();var t=ft_seat_minimap_mouse_position.mx-e.pageX,a=ft_seat_minimap_mouse_position.my-e.pageY,s=$(".section-seat .theater"),i=s.find(".content"),n=($("#minimap"),$("#minimap .mini_container")),o=$("#minimap .mini_region"),r=n.width(),c=n.height(),l=r-o.width()+5,d=c-o.height()+25,_=ft_seat_minimap_mouse_position.lx-t,p=ft_seat_minimap_mouse_position.ly-a;_<5&&(_=5),l<_&&(_=l),p<25&&(p=25),d<p&&(p=d),o.css({left:_+"px",top:p+"px"});var u=i.get(0).scrollHeight,f=i.get(0).scrollWidth,m=u-s.height(),S=f-s.width(),v=Math.round((_-5)/(l-5)*S),N=Math.round((p-25)/(d-25)*m);i.scrollLeft(v),i.scrollTop(N)}function ftSeatMinimapUpListener(e){e.preventDefault(),ft_seat_minimap_dragging=!1,$(document).unbind("mouseup",ftSeatMinimapUpListener),$(document).unbind("mousemove",ftSeatMinimapMoveListener),ftSeatMinimapMoveListener(e)}function STEP2_NOPYouthShow(){$(".step2 .section-numberofpeople .numberofpeople-select .group.youth").removeClass("hide")}function STEP2_NOPYouthHide(){$(".step2 .section-numberofpeople .numberofpeople-select .group.youth").addClass("hide")}function notNullDecryption(e){return e?$.cgv.data["통신"]["복호화"](e):e}function loadPrereservateSeats(a){$.cgv.data.고객선택정보.좌석.예매인원수=selectNumData.total(),$.cgv.data.고객선택정보.선택좌석정보.표가격.length=0,$.cgv.data.고객선택정보.선택좌석정보.표가격_사용.length=0,$.cgv.data.고객선택정보.선택좌석정보.총결제금액=0;var e=[];for(n=$.cgv.data.고객선택정보.선택좌석정보.예매좌석정보.length=0;n<selectNumData.millitary;n++)e.push("10");for(n=0;n<selectNumData.adult;n++)e.push("01");for(n=0;n<selectNumData.youth;n++)e.push("02");for(n=0;n<selectNumData.child;n++)e.push("05");for(n=0;n<selectNumData.senior;n++)e.push("04");for(n=0;n<selectNumData.special;n++)e.push("03");for(var t=[],s=$(".section-seat .theater .seats .row .seat.selected"),i=seatPSE_Sort(s),n=0;n<i.length;n++){var o=i[n],r=(ft_ticket_prices[o.RATING_CD+e[n]],{});if(r.LOC_NO=o.SEAT_LOC_NO,r.LOC_Y_NM=o.LOC_Y_NM,r.LOC_INFO=ftGetLocName(o.LOC_Y_NM)+parseInt(o.SEAT_NO,10),r.SEAT_NO=o.SEAT_NO,r.RATING_CD=o.RATING_CD,r.RATING_NM=o.RATING_NM,r.AGE_GRADE=e[n],r.PRICE=ft_ticket_prices[o.RATING_CD+e[n]],t.length<=0)t.push(r);else for(var c=parseInt(r.PRICE,10),l=0;l<t.length;++l){if(parseInt(t[l].PRICE,10)<=c){t.splice(l,0,r);break}t.push(r);break}}var d=[],_=[],p=[],u=[],f=[];e=[];for(var m=0;m<t.length;++m){var S=t[m];d.push(S.LOC_NO),_.push(S.RATING_CD),p.push(S.PRICE),u.push(S.LOC_Y_NM),f.push(S.SEAT_NO),e.push(S.AGE_GRADE),$.cgv.data.고객선택정보.선택좌석정보.표가격.push(S.PRICE),$.cgv.data.고객선택정보.선택좌석정보.표가격_사용.push(S.PRICE),$.cgv.data.고객선택정보.선택좌석정보.총결제금액+=parseInt(S.PRICE,10),$.cgv.data.고객선택정보.선택좌석정보.예매좌석정보.push(S.LOC_INFO),$.cgv.data.고객선택정보.선택좌석정보.좌석등급코드=S.RATING_NM}var v=$.cgv.api.ticket.PrereservateSeats.PARAMS;(v={}).TheaterCd=$.cgv.data.고객선택정보.극장.극장코드,v.PlayYMD=$.cgv.data.고객선택정보.날짜.상영일자,v.ScreenCd=$.cgv.data.고객선택정보.상영관시간.상영관코드,v.PlayNum=$.cgv.data.고객선택정보.상영관시간.상영회차,v.ReseveCnt=selectNumData.total(),v.SeatInfo=d.join(";"),v.SeatRatingInfo=_.join(";"),v.TicketTypeInfo=e.join(";"),v.SeatPriceInfo=p.join(";"),v.LOC_Y_NM=u.join(";"),v.SEAT_NM=f.join(";"),v.MEMBER_ID=$.cgv.data.고객정보.비회원여부?$.cgv.data.고객정보.사용자아이디:$.cgv.data["통신"]["복호화"]($.cgv.data.고객정보.사용자아이디),v.PLAY_TIME_CD=$.cgv.data.고객선택정보.상영관시간.상영시간코드,"Cgv-Guest-332211"==v.MEMBER_ID?v.SOCIAL_NO=$.cgv.data["통신"]["복호화"]($.cgv.data.고객정보.사용자주민번호):v.SOCIAL_NO=$.cgv.data["통신"]["복호화"]($.cgv.data.고객정보.사용자주민번호).substr(2),v.MOBILE_NO=$.cgv.data["고객정보"]["비회원여부"]?$.cgv.data["통신"]["복호화"]($.cgv.data.고객정보.사용자핸드폰번호):$.cgv.data["통신"].UrlDecode($.cgv.data.고객정보.사용자핸드폰번호),v.MOVIE_CD=$.cgv.data.고객선택정보.영화.영화코드;var N=$.cgv.data.고객정보.비회원여부?$.cgv.data["고객정보"]["CJONE회원번호"]:$.cgv.data["통신"]["복호화"]($.cgv.data["고객정보"]["CJONE회원번호"]),h=$.cgv.api.ticket.PrereservateSeats;$.cgv.net.loadAPI(h,v,{success:function(e){var t=$.cgv.api.ticket.PrereservateSeats.parseData(e);"00000"==t.SMS_RESULT.RES_CD?($.cgv.data.좌석가확보완료정보.고객주민번호=notNullDecryption($.cgv.data.고객정보.사용자주민번호),$.cgv.data.좌석가확보완료정보.고객명=notNullDecryption($.cgv.data.고객정보.사용자명),$.cgv.data.좌석가확보완료정보.CJONE포인트회원여부="Y",$.cgv.data.좌석가확보완료정보.고객아이디=v.MEMBER_ID,$.cgv.data.좌석가확보완료정보.고객이메일=notNullDecryption($.cgv.data.고객정보.이메일주소),$.cgv.data.좌석가확보완료정보.휴대전화번호=notNullDecryption($.cgv.data.고객정보.사용자핸드폰번호),$.cgv.data.좌석가확보완료정보.집전화번호=notNullDecryption($.cgv.data.고객정보.사용자유선전화번호),$.cgv.data.좌석가확보완료정보.예매일자=$.cgv.data.고객정보.예매일자,$.cgv.data.좌석가확보완료정보.CJONE회원번호=N,$.cgv.data.좌석가확보완료정보.회원번호=N,$.cgv.data.좌석가확보완료정보.아이핀번호=notNullDecryption($.cgv.data.고객정보.사용자IPIN),$.cgv.data.좌석가확보완료정보.임시예매번호=t.SMS_RESULT.RESERVE_NO,$.cgv.data.좌석가확보완료정보.극장명=$.cgv.data.고객선택정보.극장.극장명,$.cgv.data.좌석가확보완료정보.극장코드=$.cgv.data.고객선택정보.극장.극장코드,$.cgv.data.좌석가확보완료정보.상영관명=$.cgv.data.고객선택정보.상영관시간.상영관명,$.cgv.data.좌석가확보완료정보.상영관코드=$.cgv.data.고객선택정보.상영관시간.상영관코드,$.cgv.data.좌석가확보완료정보.상영시간=$.cgv.data.고객선택정보.상영관시간.상영시간,$.cgv.data.좌석가확보완료정보.상영일자=$.cgv.data.고객선택정보.날짜.상영일자,$.cgv.data.좌석가확보완료정보.상영요일=$.cgv.data.고객선택정보.날짜.상영요일,$.cgv.data.좌석가확보완료정보.상영회차=$.cgv.data.고객선택정보.상영관시간.상영회차,$.cgv.data.좌석가확보완료정보.영화명=$.cgv.data.고객선택정보.영화.영화명,$.cgv.data.좌석가확보완료정보.영화코드=$.cgv.data.고객선택정보.영화.영화코드,$.cgv.data.좌석가확보완료정보.영화등급코드=$.cgv.data.고객선택정보.영화.영화등급코드,$.cgv.data.좌석가확보완료정보.예매인원수=$.cgv.data.고객선택정보.좌석.예매인원수,$.cgv.data.좌석가확보완료정보.상영종료시간=$.cgv.data.고객선택정보.상영관시간.상영종료시간,$.cgv.data.좌석가확보완료정보.상영시간코드=$.cgv.data.고객선택정보.상영관시간.상영시간코드,$.cgv.data.좌석가확보완료정보.총결제금액=$.cgv.data.고객선택정보.선택좌석정보.총결제금액+"",$.cgv.data.좌석가확보완료정보.예매좌석등급코드=$(".section-seat .theater .seats .row .seat.selected").eq(0).data("xml").RATING_CD,$.cgv.data.좌석가확보완료정보.표가격=$.cgv.data.고객선택정보.선택좌석정보.표가격,$.cgv.data.좌석가확보완료정보.영화포스터URL=$.cgv.data.고객선택정보.영화.영화포스터url,$.cgv.data.좌석가확보완료정보.예매좌석정보=$.cgv.data.고객선택정보.선택좌석정보.예매좌석정보,$.cgv.data.좌석가확보완료정보.군인인원수=$.cgv.data.고객선택정보.좌석.군인인원수,$.cgv.data.좌석가확보완료정보.일반인원수=$.cgv.data.고객선택정보.좌석.일반인원수,$.cgv.data.좌석가확보완료정보.학생인원수=$.cgv.data.고객선택정보.좌석.학생인원수,$.cgv.data.좌석가확보완료정보.어린이인원수=$.cgv.data.고객선택정보.좌석.어린이인원수,$.cgv.data.좌석가확보완료정보.경로인원수=$.cgv.data.고객선택정보.좌석.경로인원수,$.cgv.data.좌석가확보완료정보.우대인원수=$.cgv.data.고객선택정보.좌석.우대인원수,$.cgv.data.좌석가확보완료정보.가격다변화코드=t.SMS_RESULT.PROMOTION_TYPE,$.cgv.data.좌석가확보완료정보.가격다변화할인율=t.SMS_RESULT.DISC_COUNT_PRICE_PERCENTAGE,selectedMovieInfo.isBool("cultureDay")&&alert(MSG2_PROMOTION_CULDAY_NOTICE),a&&a()):alert(t.SMS_RESULT.RES_MSG)},error:silentLoadErrorListener})}function loadPrereservateSeatsCancel(t){if(""!=$.cgv.data.좌석가확보완료정보.임시예매번호){var e=$.cgv.api.ticket.PrereservateSeatsCancel.PARAMS;(e={}).TheaterCd=$.cgv.data.좌석가확보완료정보.극장코드,e.PlayYMD=$.cgv.data.좌석가확보완료정보.상영일자,e.ScreenCd=$.cgv.data.좌석가확보완료정보.상영관코드,e.PlayNum=$.cgv.data.좌석가확보완료정보.상영회차,e.ReserveNo=$.cgv.data.좌석가확보완료정보.임시예매번호,$.cgv.net.loadAPI($.cgv.api.ticket.PrereservateSeatsCancel,e,{success:function(e){$.cgv.api.ticket.PrereservateSeatsCancel.parseData(e);$.cgv.data.좌석가확보완료정보.초기화(),t&&t()},error:silentLoadErrorListener})}}function ftLoadSeatLayout(){loadSeatInfo(function(){$("#maximum_people").text(IS_ENGLISH?"* Maximum number of people for reservation is "+MAX_RESERVATION_COUNT:"* 최대 "+MAX_RESERVATION_COUNT+"명 선택 가능");var e=$(".seat-icon-desc").find(".distanced");e.hide(),"99"!==DISTANCE_CLS&&e.show(),theaterNoticeChecker(),ticketDrawTheater(),ticketStep2Update()})}function loadSeatInfo(n){var o=APILoader.init();o.URL="/CJ000.aspx/CJ_002_PRIME_ZONE_LANGUAGE",o.PARAMS.Language=$.cgv.config.LANGUAGE,o.PARAMS.TheaterCd=$.cgv.data.고객선택정보.극장.극장코드,o.PARAMS.PlayYMD=$.cgv.data.고객선택정보.날짜.상영일자,o.PARAMS.ScreenCd=$.cgv.data.고객선택정보.상영관시간.상영관코드,o.PARAMS.PlayNum=$.cgv.data.고객선택정보.상영관시간.상영회차,$.cgv.net.loadAPI(o,o.PARAMS,{success:function(e){var t=o.parseData(e);ft_ticket_prices={},$(t.PRICE_INFO).each(function(){ft_ticket_prices[this.RATING_CD+this.TICKET_TYPE]=parseInt(this.PRICE,10)});var a=t.DISTANCE_SEATING_INFO;MAX_RESERVATION_COUNT=a.RESR_PEOPLE?parseInt(a.RESR_PEOPLE,10):8,DISTANCE_CLS=a.DISTANCE_CLS;var s=t.SCREEN_INFO;$.cgv.data.고객선택정보.극장.극장명=s.THEATER_NM,$.cgv.data.고객선택정보.극장.극장코드=s.THEATER_CD,$.cgv.data.고객선택정보.상영관시간.상영관명=s.SCREEN_NM,$.cgv.data.고객선택정보.상영관시간.상영관코드=s.SCREEN_CD;var i=$("#user-select-info");i.find(".site").text(s.THEATER_NM),i.find(".screen").text(s.SCREEN_NM),$.cgv.data.SEAT_INFO=t,n()},error:silentLoadErrorListener},"",!1)}function ticketStep2PopupCheck(){var e=$.cgv.data.고객선택정보,t=(e["극장"]["극장코드"],e["영화"]["영화코드"],e["영화"]["영화명"]),a=(e["영화"]["영화그룹명"],e["영화"]["영화등급코드"]),s=(e["영화"].Third_Attr_CD,e["영화"].MOVIE_ATTR_CD,e["상영관시간"]["상영관코드"],e["상영관시간"]["상영관등급코드"],IS_ENGLISH?"<br/>Entrance may be restricted if your age cannot be verified.":"<br/>연령 확인 불가 시 입장이 제한 될 수 있습니다.");"01"==a&&selectedMovieInfo.isBool("greenCinema")&&ticketAlert(MSG1_MOVIE_GREENC_t,MSG1_MOVIE_GREENC_c),"01"!=a||selectedMovieInfo.isBool("greenCinema")||ticketAlert(MSG2_MOVIE_RATING_t,MSG2_MOVIE_RAGING_c,"adultNotice"),"02"==a&&ticketAlert(MSG2_MOVIE_RATING_t,MSG2_MOVIE_RAGING_15+s),"03"==a&&ticketAlert(MSG2_MOVIE_RATING_t,MSG2_MOVIE_RAGING_12+s),-1<t.indexOf("러브맘")&&"2"==e.상영관시간.상영회차&&ticketAlert(MSG2_LOVE_MOM_t,MSG2_LOVE_MOM_c),homeCMS.get(function(e){if(e)for(var t=e.length-1;0<=t;t--){var a=e[t].IMAGE_URL,s=IS_ENGLISH?e[t].CONTENT_HE.replace(/\n/g,"<br/>"):e[t].CONTENT;if(a)if(s){var i='<p class="inner"><img src="'+a+'" width="440" height="238"><span class="bd_comment">'+s+"</span></p>";ticketAlert2(MSG2_CINEMA_NOTI_T,i,"both")}else{i='<p class="inner"><img src="'+a+'" width="410" height="410"></p>';ticketAlert2(MSG2_CINEMA_NOTI_T,i)}else if(s){i='<p class="inner"><span class="bd_comment">'+s+"</span></p>";ticketAlert2(MSG2_CINEMA_NOTI_T,i,"content")}}})}function ticketStep2PeopleCountCheck(e){if(0==e)return!0;var t=!0;switch($.cgv.data.고객선택정보.상영관시간.상영관등급코드){case"15":e%2!=0&&isPremiumTheater()&&(alert(MSG2_PREMIUM),t=!1);break;case"20":e%2!=0&&(alert(MSG2_TEMPER),t=!1);break;case"14":e%2!=0&&(alert($.cgv.data.고객선택정보.상영관시간["상영관등급명"]+"상영관은 2인, 4인, 6인 또는 8인 예매만 가능합니다."),t=!1);break;case"30":2!==e&&(IS_ENGLISH?alert("'CGV Drive in Theater' can be booked for 2 people."):alert("'CGV Drive in' 은 자동차 1대당 2인 기준 단위 예매만 가능합니다.\n       (인원수 관계없이 차량 기준으로 차량 1대 = 2명 선택)"),t=!1)}return t}var FIRST_ALLEY_X=new Array,ft_person_count=0,ft_seat_remain_count=0,ft_seat_select_count=0,ft_adj_seat_count=0,ft_seat_group_idx=0,ft_selected_seat_rating="",ft_adjacent_seats=[],ft_ticket_prices={},ft_seat_filter_type=0;function ftUpdateSeatCounting(){var e=$("#seats_list .row .seat.selected");ft_person_count=selectNumData.total(),ft_seat_select_count=e.length,ft_seat_remain_count=ft_person_count-ft_seat_select_count,ft_selected_seat_rating="",0<ft_seat_select_count&&(ft_selected_seat_rating=e.first().data("xml").RATING_CD),ftSetAdjacentSeatSelector(ft_seat_remain_count),ftResetSeatGrouping(),ftMarkNotAvailSeats(),tnbUpdate()}function ftResetAdjacentSeatSelector(){var e=$("#adjacent_seat .seat_block");if(e.removeClass("enabled"),e.find("input").prop("disabled",!0),e.each(function(e){$(this),e<ft_seat_remain_count?($(this).addClass("enabled"),$(this).find("input").prop("disabled",!1)):($(this).removeClass("enabled"),$(this).find("input").prop("disabled",!0)),"02"!=ft_selected_seat_rating&&"11"!=ft_selected_seat_rating&&"10"!=ft_selected_seat_rating&&"09"!=userSelect_info_cinema_rate&&"20"!=userSelect_info_cinema_rate||e%2==0&&($(this).removeClass("enabled"),$(this).find("input").prop("disabled",!0))}),0==$("#adjacent_seat .seat_block.selected.enabled").length){var t=$("#adjacent_seat .seat_block.enabled").last();t.addClass("selected"),$("#adjacent_seat .seat_block input").prop("checked",!1),t.find("input").prop("checked",!0),ftSetAdjacentSeatSelector(t.index()+1,t)}0<$("#adjacent_seat .seat_block.selected input").size()&&($("#adjacent_seat .seat_block.selected input").get(0).checked=!0),isNonOddTheater||("15"==$.cgv.data.고객선택정보.상영관시간.상영관등급코드?2==ft_person_count||4==ft_person_count?e.each(function(e){switch($(this),e){case 0:case 2:$(this).removeClass("enabled"),$(this).find("input").prop("disabled",!0)}}):e.each(function(e,t){$(t).removeClass("enabled"),$(t).find("input").prop("disabled",!0)}):"09"==$.cgv.data.고객선택정보.상영관시간.상영관등급코드?ft_person_count%2==0?e.each(function(e){switch($(this),e){case 0:case 2:$(this).removeClass("enabled"),$(this).find("input").prop("disabled",!0)}}):e.each(function(e,t){$(t).removeClass("enabled"),$(t).find("input").prop("disabled",!0)}):"04"==$.cgv.data.고객선택정보.상영관시간.상영관등급코드&&(2==ft_person_count||4==ft_person_count?e.each(function(e){switch($(this),e){case 0:case 2:$(this).removeClass("enabled"),$(this).find("input").prop("disabled",!0)}}):e.each(function(e,t){$(t).removeClass("enabled"),$(t).find("input").prop("disabled",!0)})))}function ftSetAdjacentSeatSelector(e,t,a){isNonOddTheater&&"15"==$.cgv.data.고객선택정보.상영관시간.상영관등급코드&&(e<=2&&(e=2),t=void 0),(null==t||$(t).closest(".seat_block").hasClass("enabled"))&&(ft_seat_remain_count<e&&(e=ft_seat_remain_count),$("#adjacent_seat .seat_block").removeClass("selected"),$("#adjacent_seat .seat_block input").prop("checked",!1),$("#adjacent_seat .seat_block.block"+e).addClass("selected"),$("#adjacent_seat .seat_block.block"+e+" input").prop("checked",!0),2<(ft_adj_seat_count=e)&&(ft_adj_seat_count=2),setTimeout("ftSetAdjacentSeatSelectorDelay()",0),1!=a&&ftMarkNotAvailSeats())}function ftSetAdjacentSeatSelectorDelay(){var e,t;$("#adjacent_seat a").each(function(){e=$(this),t=e.find(".blind_msg"),e.hasClass("selected")?t.html(" 선택됨"):e.hasClass("enabled")?t.html(""):t.html(" 선택불가")})}function ftChooseSeatGroupDirection(){var a,s,i,n,o;$("#seats_list .row .seat_group").each(function(e,t){a=$(t),s=a.find(".seat"),i=s.last().data("xml"),n=parseInt(i.LOC_X,10),o=parseInt(i.LOC_Y,10),100<=FIRST_ALLEY_X[o-1]||n<FIRST_ALLEY_X[o-1]&&(a.data("leftside","Y"),a.addClass("left"))})}function ftSeatRowEvent(e){var t=$(e.currentTarget?e.currentTarget:e.srcElement).parents(".row");switch(e.type){case"focus":case"mouseenter":$("#seats_list .row").removeClass("hasmouse hasfocus"),t.addClass("hasmouse");break;case"blur":case"mouseleave":t.removeClass("hasmouse")}}function ftMarkNotAvailSeats(){var e,t=$("#seats_list .row"),a=t.find(".group"),s=t.find(".seat");(s.removeClass("notavail"),1===ft_seat_remain_count)&&a.not(".reserved").each(function(e){var t=$(this),a=t.find(".seat");"Y"!==t.data("sweetbox")&&"Y"!==t.data("couple")||a.addClass("notavail"),2<a.length?a.each(function(e){1!=e&&e!=a.length-2||$(this).addClass("notavail")}):a.removeClass("notavail")});(0<selectNumData.child||0<selectNumData.senior||0<selectNumData.special||0<selectNumData.total()%2)&&a.find(".sweet, .eggbox, .coupleSofa").addClass("notavail");var i=s.not(".selected",".reserved");"02"==ft_selected_seat_rating?i.not(".sweet").addClass("notavail"):"03"==ft_selected_seat_rating?i.not(".veat").addClass("notavail"):"11"==ft_selected_seat_rating?i.not(".couple").addClass("notavail"):"16"==ft_selected_seat_rating?i.not(".eggbox").addClass("notavail"):"26"==ft_selected_seat_rating?i.not(".coupleSofa").addClass("notavail"):"30"==ft_selected_seat_rating?i.not(".coupleSofa").addClass("notavail"):"31"===ft_selected_seat_rating?i.not(".suite_A").addClass("notavail"):"32"===ft_selected_seat_rating?i.not(".suite_B").addClass("notavail"):"33"===ft_selected_seat_rating&&i.not(".familyRecliner").addClass("notavail");for(var n=a.find(".seat.reserved").not(".blocked, .distanced"),o=0;o<n.length;o++){var r=n.eq(o).data("xml");if(("31"===r.RATING_CD||"32"===r.RATING_CD||"33"===r.RATING_CD||"05"===r.RATING_CD)&&"000"!==r.SEAT_RELATION_CODE){var c="";switch(r.RATING_CD){case"31":c="suite_A";break;case"32":c="suite_B";break;case"33":c="familyRecliner";break;case"05":c="seat"}for(var l=a.find("."+c),d=0;d<l.length;d++){var _=l.eq(d),p=_.data("xml");p.LOC_Y===r.LOC_Y&&p.RATING_CD===r.RATING_CD&&p.SEAT_RELATION_CODE===r.SEAT_RELATION_CODE&&(_.hasClass("reserved")||_.addClass("notavail"))}}}var u=!1,f=null;""!=ft_selected_seat_rating&&("12"!==ft_selected_seat_rating&&"13"!==ft_selected_seat_rating&&"14"!==ft_selected_seat_rating||(u=!0),i.each(function(){(f=$(this).data("xml").RATING_CD)!=ft_selected_seat_rating&&(u&&"12"!==f&&"13"!==f&&"14"!==f&&$(this).addClass("notavail"),u||$(this).addClass("notavail"))}));"24"===$.cgv.data.고객선택정보.상영관시간.상영관등급코드&&ft_person_count%2!=0&&s.not(".beanbag").addClass("notavail"),s.each(function(){(e=$(this)).find(".blind_msg").html(""),e.hasClass("selected")&&e.find(".blind_msg").html("선택됨"),e.hasClass("notavail")&&e.find(".blind_msg").html("선택불가")})}function ftDisableGroup(e){var t;e.each(function(){(t=$(this)).hasClass("reserved")||t.hasClass("selected")||t.addClass("notavail")})}function ftGetSeatListGroup(e){var t=e.find(".seat");return"Y"==e.parents(".seat_group").data("leftside")&&(t=t.reverse()),t}function ftGetAdjacentSeats(e){if(!e.hasClass("notavail")&&!e.hasClass("reserved")){ft_adjacent_seats.length=0;var t,a,s=ftGetSeatListGroup(e.parent()),i=s.length,n=i%2==1;switch(0===ft_seat_remain_count&&(ft_adj_seat_count=1===ft_person_count?1:2),1===ft_seat_remain_count&&(ft_adj_seat_count=ft_seat_remain_count),ft_adj_seat_count){case 1:ft_adjacent_seats.push(e);break;case 2:a=(t=ftGetIndex(s,e))-t%2,n&&a==i-1?(ft_adjacent_seats.push(s.eq(a-1)),ft_adjacent_seats.push(s.eq(a))):(ft_adjacent_seats.push(s.eq(a)),ft_adjacent_seats.push(s.eq(a+1)));break;case 3:a=i-3<=(t=ftGetIndex(s,e))?i-3:t-t%2,ft_adjacent_seats.push(s.eq(a)),ft_adjacent_seats.push(s.eq(a+1)),ft_adjacent_seats.push(s.eq(a+2));break;case 4:a=i-4<=(t=ftGetIndex(s,e))?i-4:t-t%2,ft_adjacent_seats.push(s.eq(a)),ft_adjacent_seats.push(s.eq(a+1)),ft_adjacent_seats.push(s.eq(a+2)),ft_adjacent_seats.push(s.eq(a+3))}return ft_adjacent_seats}}function ftGetIndex(e,a){var s=-1;return e.each(function(e,t){if($(t)[0]==a[0])return s=e,!1}),s}function ftResetSeatGrouping(){$(".section-seat .theater .seats .row .group").addClass("to_be_removed");var a,s,i,n,o,r,c,l,d,_,p,u,f,m,S,v,N,e=$(".section-seat .theater .seats .row .seat a:focus"),t=$(".section-seat .theater .seats .row .seat"),h=!1;t.each(function(e,t){a=$(t),n=a.parents(".seat_group"),n.parents(".row"),s=a.data("xml"),r=parseInt(s.LOC_Y,10),c=parseInt(s.LOC_X,10),parseInt(s.SEAT_NO,10),_=s.SEAT_STATE,u=a.hasClass("selected"),m=s.RATING_CD,v=s.KIND_CD,h=!1,l!=r?h=!0:1<c-d?h=!0:_!=p?h=!0:m!=S?h=!0:u!=f?h=!0:v!=N&&(h=!0),h&&(i="<div class='group","N"==_&&(i+=" reserved"),i+="'></div>",o=$(i),n.append(o)),o.append(a),"02"==m?o.data("sweetbox","Y"):"11"==m&&o.data("couple","Y"),l=r,d=c,p=_,S=m,f=u,N=v}),0<e.length&&e.focus(),ftPreselectSeatsClear(),useTimeout?setTimeout("ftResetSeatGroupingDelay();",0):ftResetSeatGroupingDelay()}function ftResetSeatGroupingDelay(){$("#seats_list .row .group.to_be_removed").remove(),setScreenReaderSeat()}function ftPreselectSeatsClear(){if(CMN_OSBR.ff)$(".section-seat .theater .seats .row .seat.preselect").removeClass("preselect"),ft_preselect_seats.length=0;else{for(var e=ft_preselect_seats.length,t=0;t<e;t++)ft_preselect_seats[t].removeClass("preselect");ft_preselect_seats.length=0}}var ft_preselect_seats=[];function ftSeatMouseEnterListener(e){var t=$(e.currentTarget?e.currentTarget:e.srcElement).parent();if(!t.hasClass("selected")&&!t.hasClass("notavail")&&!t.hasClass("reserved")){ftPreselectSeatsClear(),ftGetAdjacentSeats(t);for(var a,s=ft_adjacent_seats.length,i=0;i<s;i++)(a=ft_adjacent_seats[i]).addClass("preselect"),ft_preselect_seats.push(a)}}function ftSeatMouseLeaveListener(e){ftPreselectSeatsClear()}function ftSeatClickListener(e){if(!(0<getLoadingCount())){var t=$(e.currentTarget?e.currentTarget:e.srcElement).parent();if(!t.hasClass("notavail")&&!t.hasClass("reserved")){if(t.hasClass("mybox")&&!t.hasClass("selected"))if(!confirm(IS_ENGLISH?"The seats you have selected are single seats with a partition on both sides. Would you like to continue?":"선택하신 좌석은 양사이드에 칸막이가 설치된 1인 전용 좌석입니다, 계속하시겠습니까?"))return!1;_showLoadingIE();var a,s,i=$.cgv.api.coupon,n=[i.CouponListNAuthCGVDiscount,i.CouponListNAuthCGVDiscountTotal];t.hasClass("primezone")?(n[0].PARAMS["프라임여부"]="1",n[1].PARAMS["프라임여부"]="1"):(n[0].PARAMS["프라임여부"]="0",n[1].PARAMS["프라임여부"]="0"),ftGetAdjacentSeats(t),0==ft_adjacent_seats.length&&(isNonOddTheater||alert(MSG1_NO_SELECT_PERSON),skipToSomething("skip_seat_list"));var o,r,c,l=!1;if(t.hasClass("selected")){s=t.data("sgi");var d=$(".section-seat .theater .seats .row .seat.sgi"+s),_=d.length;1<_?(r=[],d.each(function(){a=$(this),o=a.data("xml"),r.push(ftGetLocName(o.LOC_Y_NM)+parseInt(o.SEAT_NO,10))}),c="붙임좌석으로 선택하신 다음 "+_+"개의 좌석을 선택 취소하시겠습니까?\n",c=MSG2_ADJ_SEAT_DESELECT+_+"개: ",c+=r.join(", "),confirm(c)&&d.removeClass("selected sgi"+s)):1==_&&t.removeClass("selected sgi"+s),1===ft_seat_select_count&&ftResetAllSeats()}else{if(0<ft_person_count&&ft_person_count==ft_seat_select_count){if(0==confirm(MSG2_SELECT_OTHER_SEAT))return ftPreselectSeatsClear(),void _hideLoadingIE();l=!0}if(isNonOddTheater&&t.attr("class").match(/couple|sweet|veat/)){var p=t.parent().parent().find(".seat");p.length%2==1&&1==ft_seat_remain_count&&alert(MSG2_SEAT_COUPLE_NOTI_3),p.length%2==0&&1==ft_seat_remain_count&&alert(MSG2_SEAT_COUPLE_NOTI_2)}var u=!0,f=[].concat(ft_adjacent_seats),m=$("#seats_list .row").find(".group"),S=t.data("xml");if(("31"===S.RATING_CD||"32"===S.RATING_CD||"33"===S.RATING_CD||"05"===S.RATING_CD)&&"000"!==S.SEAT_RELATION_CODE){var v="",N="";switch(S.RATING_CD){case"31":v="suite_A",N="Suite A";break;case"32":v="suite_B",N="Suite B";break;case"33":v="familyRecliner",N=IS_ENGLISH?"Family Recliner":"패밀리 리클라이너";break;case"05":v="seat",N=IS_ENGLISH?"GoldClass":"골드클래스"}for(var h=m.find("."+v),I=new Array,g=new Array,C=0;C<h.length;C++){var E=h.eq(C).data("xml");E.LOC_Y===S.LOC_Y&&E.RATING_CD===S.RATING_CD&&E.SEAT_RELATION_CODE===S.SEAT_RELATION_CODE&&"N"!==E.SEAT_STATE&&(I.push(h.eq(C)),g.push(ftGetLocName(E.LOC_Y_NM)+parseInt(E.SEAT_NO,10)))}var T=I.length;if(ft_seat_remain_count<T)if(!l||ft_person_count<T){var A=IS_ENGLISH?"The selected seat '"+N+"' is for "+T+" people.\nPlease select the number of people in increments of "+T+" people.\n\nConnecting seats: "+g.join(", "):"선택하신 '"+N+"' 좌석은 "+T+"인 좌석입니다.\n"+T+"인 단위로 인원을 선택해주세요.\n\n연결 좌석: "+g.join(", ");alert(A),u=!1}else f=I;else f=I}for(C=0;C<f.length;C++){if(a=f[C],0<selectNumData.millitary){var b=a.data().xml;if(void 0===ft_ticket_prices[b.RATING_CD+"10"]){var M=b.RATING_NM;"석"===M.charAt(M.length-1)&&(M=M.slice(0,M.length-1)),a.hasClass("handicap")&&(M="장애인"),alert(M+"석은 군인할인이 적용되지 않습니다. \n좌석을 다시 선택해주세요."),u=!1;break}}if(a.hasClass("handicap")){0==confirm("11"!==$.cgv.data.고객선택정보["상영관시간"]["상영관등급코드"]?MSG2_SEAT_HANDICAP:MSG2_SEAT_HANDICAP_4DX)&&(_hideLoading(),u=!1);break}if(0<selectNumData.child&&a.hasClass("sweet")){alert("어린이 요금제 이용시 스위트 박스석 이용이 제한 됩니다."),u=!1;break}}if(!u)return numPeopleClickProcess(),!1;for(l&&($("#seats_list .row .seat").removeClass("selected"),numPeopleClickProcess()),s=ft_seat_group_idx++,C=0;C<f.length;C++)(a=f[C]).addClass("selected sgi"+s),a.data("sgi",s)}ftUpdateSeatCounting(),ftResetAdjacentSeatSelector(),setTimeout("ftSeatClickListenerDelay()",10)}}}function ftSeatClickListenerDelay(){1!=ft_person_count&&ftResetSeatGrouping(),ft_person_count<=ft_seat_select_count?$("#ft_nextstep_btn_2 span.blind").html("으로 진행하기"):$("#ft_nextstep_btn_2 span.blind").html("으로 진행하기 불가"),ftMarkNotAvailSeats(),tnbUpdate(),_hideLoadingIE()}function ftSeatFocusListener(e){if("focus"==e.type){var t,a=$(e.currentTarget?e.currentTarget:e.srcElement).parent();if(a.hasClass("selected"))return;if(a.hasClass("notavail"))return;if(a.hasClass("reserved"))return;ftPreselectSeatsClear(),ftGetAdjacentSeats(a);for(var s=ft_adjacent_seats.length,i=0;i<s;i++)(t=ft_adjacent_seats[i]).addClass("preselect"),ft_preselect_seats.push(t)}else ftPreselectSeatsClear()}function ftResetAllSeats(e){ftUpdateSeatCounting(),ftResetAdjacentSeatSelector(),ftLoadSeatLayout()}function ftSetSeatLayoutZoom(e){var t,a,s,i,n,o,r,c=$(".section-seat .theater"),l=$("#seats_list"),d=l.data("width"),_=l.data("height"),p=$("#seat_zoom_btn");e?(p.addClass("on"),c.addClass("zoom"),d=l.data("width_zoom"),_=l.data("height_zoom"),l.css({width:d+"px",height:_+"px"})):(p.removeClass("on"),c.removeClass("zoom"),l.css({width:d,height:_})),$("#seats_list .row").each(function(){t=$(this),a=t.data("top"),e&&(a=t.data("top_zoom")),t.css({top:a+"px"})}),$("#seats_list .row .seat").each(function(){s=$(this),i=s.data("left"),e&&(i=s.data("left_zoom")),s.css({left:i+"px"})}),$("#seats_list .exit").each(function(){n=$(this),o=n.data("top"),r=n.data("left"),e&&(o=n.data("top_zoom"),r=n.data("left_zoom")),n.css({top:o+"px",left:r+"px"})})}function ftGetLocName(e){return e.split(" ").join("")}function ticketStep2TimeSelectPopupShow(){var e=$("#section_time_popup");if(e.is(":visible"))ticketStep2TimeSelectPopupHide();else{if(e.unbind("mousedown").bind("mousedown",function(e){return!1}),$(document.body).unbind("mousedown",ticketStep2TimeSelectPopupHide).bind("mousedown",ticketStep2TimeSelectPopupHide),e.find(".btn_cancel").unbind("click").bind("click",function(e){ticketStep2TimeSelectPopupHide()}),e.find(".btn_ok").unbind("click").bind("click",function(e){if(0!=$("#section_time_popup .time-list ul li.preselect").size()){var t,a=$("#section_time_popup .time-list ul li.preselect");if(t=$.isArray($.cgv.data.TIMETABLE.Table)?$.cgv.data.TIMETABLE.Table[a.prop("data-index")]:$.cgv.data.TIMETABLE.Table,!selectTime(t,!0))return;ticketStep2TimeSelectPopupHide(),ticketStep2Init()}else ticketStep2TimeSelectPopupHide()}),$("#section_time_popup .time-list").remove(),null!=$.cgv.data.TIMETABLE.Table){var t=$.cgv.data.TIMETABLE.Table,a=$('<div class="time-list nano"></div>'),N=$('<div class="content scroll-y"></div>');a.append(N),$("#section_time_popup .sprite").append(a),$(t).each(function(e,a){if(_theaterListType==THEATER_LIST_TYPE.SPECIALTHEATER&&a.SCREEN_RATING_CD!=$.cgv.data.고객선택정보.극장.상영관종류)return!0;var t,s=a.SEAT_CAPACITY+"";if($($.cgv.data.REMAIN_SEAT_INFO).each(function(e,t){return null==t||(a.SCREEN_CD==t.SCREEN_CD&&parseInt(a.PLAY_NUM,10)==parseInt(t.PLAY_NUM,10)?(s=parseInt(t.REMAIN_SEAT,10),!1):void 0)}),N.find("div.theater").is("[SCREEN_CD="+a.SCREEN_CD+"][MOVIE_CD="+a.MOVIE_CD+"]"))t=N.find("div.theater[SCREEN_CD="+a.SCREEN_CD+"][MOVIE_CD="+a.MOVIE_CD+"] ul");else{var i="";i=""!=a.SUBTITLE_NM&&""!=a.MOVIE_ADD_ATTR?a.MOVIE_KIND_DISPLAY_NM+"("+a.SUBTITLE_NM+","+a.MOVIE_ADD_ATTR+")":""!=a.SUBTITLE_NM&&""==a.MOVIE_ADD_ATTR?a.MOVIE_KIND_DISPLAY_NM+"("+a.SUBTITLE_NM+")":""==a.SUBTITLE_NM&&""!=a.MOVIE_ADD_ATTR?a.MOVIE_KIND_DISPLAY_NM+"("+a.MOVIE_ADD_ATTR+")":a.MOVIE_KIND_DISPLAY_NM;var n,o=$('<div class="theater"></div>').attr("SCREEN_CD",a.SCREEN_CD).attr("MOVIE_CD",a.MOVIE_CD),r=$('<span class="title"></span>'),c=$('<span class="name"></span>').text(i),l=$('<span class="floor"></span>').text(a.SCREEN_NM);n=IS_ENGLISH?$('<span class="seatcount"></span>').text("(Total "+a.SEAT_CAPACITY+" seats)"):$('<span class="seatcount"></span>').text("(총"+a.SEAT_CAPACITY+"석)"),t=$("<ul></ul>"),r.append(c),r.append(l),r.append(n),o.append(r),o.append(t),N.append(o)}var d,_,p=a.PLAY_START_TM.substr(0,2)+":"+a.PLAY_START_TM.substr(2,2),u=a.PLAY_END_TM.substr(0,2)+":"+a.PLAY_END_TM.substr(2,2),f=$("<li></li>").prop("data-index",e).attr("PLAY_START_TM",a.PLAY_START_TM).attr("SCREEN_CD",a.SCREEN_CD).attr("MOVIE_CD",a.MOVIE_CD).attr("PLAY_NUM",a.PLAY_NUM),m=$('<a class="button" href="#" onclick="return false;"/>'),S=$('<span class="time"><span>'+p+"</span></span>");_=IS_ENGLISH?(d=$('<span class="count">'+s+'<div class="sreader">seats remain</div></span>'),$('<div class="sreader">End time '+u+'</div><span class="sreader mod"></span>')):(d=$('<span class="count">'+s+"석</span>"),$('<div class="sreader">종료시간 '+u+'</div><span class="sreader mod"></span>')),m.append(S),m.append(d),f.append(m),m.append(_),t.append(f),m.bind("click",function(){var e=$(this).parent("li");e.hasClass("disabled")||(e.hasClass("selected")||("Y"!=($.isArray($.cgv.data.TIMETABLE.Table)?$.cgv.data.TIMETABLE.Table[e.prop("data-index")]:$.cgv.data.TIMETABLE.Table).WARNING_TIME||confirm(MSG1_TIME_SHORT))&&($("#section_time_popup .time-list ul li").removeClass("preselect selected"),e.addClass("preselect")))});var v="종료 ";switch(IS_ENGLISH&&(v="End "),$(m).aToolTip({fixed:!0,xOffset:-8,yOffset:1,inSpeed:100,outspeed:100,toolTipClass:"tooltip-ticket-time",tipContent:"<span class='time'>"+v+u+"<span></span></span>"}),a.PLAY_TIME_CD){case"01":f.addClass("morning");break;case"03":f.addClass("night")}"Y"==a.ALLOW_SALE_YN?"0"==a.SEAT_REMAIN_CNT?(IS_ENGLISH?d.text("Sold out"):d.text("매진"),f.addClass("disabled")):"9999"==a.SEAT_REMAIN_CNT?(IS_ENGLISH?d.text("Finish"):d.text("예매종료"),f.addClass("disabled")):IS_ENGLISH?d.html(s+'<span class="sreader">seats remain</span>'):d.html(s+"석"):(IS_ENGLISH?d.text("Prepare"):d.text("준비중"),f.addClass("disabled"))}),$("#section_time_popup .time-list .theater:last-child").css("border","none"),$("#section_time_popup .time-list ul li").removeClass("selected"),$("#section_time_popup .time-list ul li[SCREEN_CD="+$.cgv.data.고객선택정보.상영관시간.상영관코드+"][PLAY_START_TM="+$.cgv.data.고객선택정보.상영관시간.상영시간+"]").addClass("selected"),setScreenReaderTime($("#section_time_popup .time-list ul li"))}e.show(),setupNanoScroller($("#section_time_popup .time-list")),e.focus(),logClick("상영시간 변경하기")}}function ticketStep2TimeSelectPopupHide(){$(document.body).unbind("mousedown",ticketStep2TimeSelectPopupHide),$("#section_time_popup").hide(),$(".section-screen-select .change_time_btn").focus()}function setScreenReaderSeat(){var a,s,i,e=$(".section-seat .theater .seats .row .seat");e.find(".sreader.mod").html(""),e.each(function(e,t){a=$(t),s=a.find(".sreader.mod"),i="",a.hasClass("selected")&&(IS_ENGLISH?i+=" selected":i+=" 선택됨"),(a.hasClass("reserved")||a.hasClass("notavail"))&&(IS_ENGLISH?i+=" can not select":i+=" 선택불가"),s.html(i)})}function skipToNextRow(e){var t=$(e.currentTarget?e.currentTarget:e.srcElement).parents(".row").next(".row");0<t.length?t.find(".skip_row").focus():skipToSomething("tnb_step_btn_right")}function ts2ClearSeats(){clearInterval(ft_seat_minimap_timer_idx),$("#minimap").css("display","none"),$("#seats_list").empty(),$(".section-seat .theater img.kia5f, .section-seat .theater img.kia6f").remove()}var kidsFamily=function(){var n=null,o=null,r=null,t=null,c=null;return{init:function(){n="",r=o=!(c=t=r=o=!1),"06"!==userSelect_info_cinema_rate||"001"!==userSelect_info_cinema_cd&&"004"!==userSelect_info_cinema_cd||(t=!0),"0245"===userSelect_info_theater_cd&&"004"===userSelect_info_cinema_cd&&(t=!0)},is:function(){return o},check:function(s){if(r&&t&&!o)s("Y");else if(r&&o)s("Y");else{var i=APILoader.init();i.URL="/CJ003.aspx/CJ_086",i.PARAMS["아이핀연계번호"]=notNullDecryption($.cgv.data.고객정보["사용자IPIN"]),i.PARAMS["이벤트인증번호"]="",i.PARAMS["이벤트코드"]="00019",i.PARAMS["구분코드"]="1",$.cgv.net.loadAPI(i,i.PARAMS,{success:function(e){var t=i.parseData(e).SMS_RESULT,a="N";o=!(r=!0),"Y"!==(n=t.MEM_YN)&&"1"!==n||(o=!0,a="Y"),s(a),o&&!c&&(c=!0,ticketAlert(MSG1_KIDSFAMILY_PRICING_t,MSG1_KIDSFAMILY_PRICING_c))},error:function(){alert(IS_ENGLISH?"":"사용자 이용정보 조회에 실패 했습니다.")}})}},join:function(){if($.cgv.data.고객정보.비회원여부){var e="현재 비회원 로그인 상태입니다. 어린이 요금제는 CGV 회원 로그인 후 이용 할 수 있습니다.\n\nCGV 회원으로 로그인하시겠습니까?";return IS_ENGLISH&&(e=MSG_CMN_LOGIN),confirm(e)&&ticketPopupShow("popup_login"),!1}e="어린이 요금은 '키즈패밀리 클럽'\n회원에 한해 이용 가능합니다.\n\n키즈패밀리 클럽에 무료 가입하시겠습니까?",t&&(e="키즈패밀리 클럽‘에 가입하셔야\n어린이 요금이 적용되며, 미가입시 할인이 적용되지 않습니다.\n\n키즈패밀리 클럽에 가입하시겠습니까?"),IS_ENGLISH&&(e="if using the child price, please join the Kids family club.\njoin the Kids family club?"),"4"===n&&(e="키즈패밀리클럽'은 만12세이하 초등학생 자녀를 둔 회원에 한해 가입이 가능합니다.\n기준 나이를 초과한 경우, 어린이 요금 발권 시 상영관 입장이 제한됩니다.\n\n키즈패밀리 클럽에 무료 가입하시겠습니까?"),confirm(e)&&function(){var e=$("#clubKizJoin",parent.document.body);if(e.length<=0){(e=$('<iframe id="clubKizJoin" class="layer-wrap clubtype" scrolling="no"/>')).attr({width:"522px",height:"100%",frameborder:"0"}).css({position:"absolute",left:$(window).width()/2-261+"px","z-index":"1000","border:":"none",top:"0"});var t=$("#contaniner",parent.document.body);1<=t.length?e.css("top","265px"):t=$("body"),t.append(e)}e.attr("src","http://www.cgv.co.kr/user/membership/KidsFamilyClub/KizClubJoinPopup.aspx?book=Y").show();var a=setInterval(function(){"none"===e.css("display")&&(clearInterval(a),ticketStep2Init())},300)}()},cineKids:function(){return t}}}(),noblessesClub=function(){var o=!1,r=!1,c=null;$('<div class="popup_noblesses"/>');return{init:function(){var e=new Date;e=e.getFullYear();var t=$.cgv.data.고객정보,a=$.cgv.data.통신.복호화(t.사용자나이);a=parseInt(a.substr(0,4),10),c=$.cgv.data.고객정보.사용자아이디,o=50<=e-a;var s,i=new Date,n=(i=i.getDate()+"")!==locStorage.item("get","expiredDate");n&&localStorage.removeItem(c),locStorage.item("get","noblessesNoShow"),(n=!1)||(o=!1),o&&((s=APILoader.init()).URL="/CJ003.aspx/CJ_086",s.PARAMS["아이핀연계번호"]=notNullDecryption($.cgv.data.고객정보["사용자IPIN"]),s.PARAMS["이벤트인증번호"]="",s.PARAMS["이벤트코드"]="00028",s.PARAMS["구분코드"]="1",$.cgv.net.loadAPI(s,s.PARAMS,{success:function(e){var t=s.parseData(e),a=t.SMS_RESULT;isChecked=!0,r="Y"===a.MEM_YN||"1"===a.MEM_YN},error:function(){alert(IS_ENGLISH?"":"사용자 이용정보 조회에 실패 했습니다.")}}))},is:function(e){var t=null;if("target"===e&&(t=o),"join"===e&&(t=r),null!==t)return t},join:function(){ticketAlert("노블레스 Club 가입안내",'<div><p>노블레스 멤버십에 무료 가입하시면 특별 할인 쿠폰을 드립니다.</br>지금 무료 가입하시겠습니까?</br></br></p><input type="checkbox" id="nbDonotShowToday" name="nbDonotShowToday"/><label for="nbDonotShowToday">오늘 하루 보지 않기</label></div>',"noblesses",function(){if(r=!0,$("#nbDonotShowToday").prop("checked")){var e=new Date;locStorage.item("set","noblessesNoShow","Y"),locStorage.item("set","expiredDate",e.getDate()+"")}})},doJoin:function(){var e=$("#noblessesJoin",parent.document.body);if(e.length<=0){(e=$('<iframe id="noblessesJoin" class="layer-wrap clubtype" scrolling="no"/>')).attr({width:"522px",height:"500px",frameborder:"0"}).css({position:"absolute",left:$(window).width()/2-261+"px","z-index":"1000","border:":"none",top:"0"});var t=$("#contaniner",parent.document.body);1<=t.length?e.css("top","265px"):t=$("body"),t.append(e)}e.attr("src","http://www.cgv.co.kr/user/membership/NobleClub/NobleClubPopup.aspx?book=Y").show();var a=setInterval(function(){"none"===e.css("display")&&(clearInterval(a),ticketStep2Init())},300)}}}(),onlinePayEvent=function(){var t={},a={type:"PAY",title:"",amount:0,code:"XXXX",donotcbr:!0,params:{}},s=$.cgv.data.좌석가확보완료정보,o=!1,i=!1,n=!1,r=null,c={tit:"",iptNM:"",tit_desc:"",notice:""},e=null,l=null;function d(){if(0===(e=$("#onlinePromotion")).length)return(l=$('<div class="promotion_message" id="promotion_message">')).html('<div class="msg"></div><a href="#" onclick="return false;">상세보기</a>'),e=$('<div id="onlinePromotion" class="tpm_special">'),promoConInnerHtml='<div class="special_header"><h3 class="title"></h3><span class="desc"></span><a class="tpmh_btn" href="#" onclick="return false;"><span></span></a></div><div class="special_body membership"><div class="row online_promotion"><div class="divider"></div><div class="title"></div><div class="card_no"><input id="onlinePayApply" type="checkbox"/><label for="onlinePayApply"></label></div><div class="result"><span></span></div></div></div>',e.html(promoConInnerHtml),e.find("div.result").css({"text-align":"left",color:"#666","line-height":"20px"}),$("div.ticket_payment_method > div.tpm_special_membership").after(e),$("#onlinePayApply").bind("change",_),void d();e.find(".title").text(c.tit),e.find("label").text(c.iptNM),e.find("span.desc").text(c.tit_desc),e.find("div.result > span").html(c.notice),i||(e.hide(),n=!1),l.find(".msg").text(c.noticeMsg),n?(l.show(),e.addClass("opened").show(),e.find('input[type="checkbox"]').prop("checked",!0)):(l.hide(),e.find('input[type="checkbox"]').prop("checked",!1),p(0)),ts3CalculatePayment()}function _(e){o=!0;var t=$(e.target);n=!!t.prop("checked"),d()}function p(e){o=!1,0===e?$("#summary_payment_list dl.code_XXXX").hide():$("#summary_payment_list dl.code_XXXX").show(),a.title=IS_ENGLISH?t.discPer+"% "+t.discNM:t.discNM+" "+t.discPer+"%할인",a.amount=e,a.params["추가할인총금액"]=e,ts3AddPaymentData(a,!0),setTimeout(ts3UpdateTitlePosi,0)}function u(){$("#specialNotice").remove(),$("#onlinePayApply").prop("checked",!1).trigger("change"),p(0)}var f={"0600":"VIP 반값할인","0100":"CGV 할인쿠폰","0820":"CJONE 할인쿠폰","0980":"카드사 할인쿠폰",Z770:"현대 M point","0250":"아시아나 마일리지",1040:"블루멤버스 포인트","0300":"GS&POINT",1090:"CJ임직원할인","0580":"KB FINETECH 할인","0570":"BC카드 할인",1050:"카카오뱅크체크카드 할인","0350":"KEB 하나카드(구 외환) 할인","0780":"NH채움카드 할인","0510":"CGV롯데카드 할인","0480":"CJONE삼성카드 할인","0530":"CJONE신한카드 할인","0550":"NH문화누리카드 할인"},m=null;return{init:d,is:function(){return n},check:function(e){if(i=!1,r=null,"N"==e.PROMOTION_TN)return!1;switch(e.PROMOTION_TYPE){case"002":case"003":case"006":n=i=!0,r=MSG2_PROMOTION_003_NOTICE,s["가격다변화코드"]=e.PROMOTION_TYPE,s["가격다변화명"]=IS_ENGLISH?"Family Offer":"Family 요금제",s["가격다변화할인율"]=$.cgv.util.parseInt(e.DISC_COUNT_PRICE_PERCENTAGE),c.tit=s["가격다변화명"],IS_ENGLISH?(c.noticeMsg=s["가격다변화할인율"]+"% "+s["가격다변화명"],c.iptNM=s["가격다변화명"],c.tit_desc="Tickets purchased with a credit card or by mobile phone payment receive a 10% discount.",c.notice="- By taking advantage of our <Family Offer>, tickets purchased with a credit card or by <br/>&nbsp;mobile phone payment receive a 10% discount.<br/>- Please note that the above discount does not work together with CJ ONE or CGV<br/>&nbsp;discount coupons, Hyundai card M point, Samsung card payback and <br/>&nbsp;Pre-discount credit card "):(c.noticeMsg=s["가격다변화명"]+" "+s["가격다변화할인율"]+"% 할인",c.iptNM=s["가격다변화명"]+" 적용",c.tit_desc="신용카드/휴대폰/카카오페이/PAYCO 결제 시 10% 할인됩니다.",c.notice="- <b>최종 결제금액 기준으로 10% 자동할인이 적용됩니다.</b><br/>&nbsp;( 할인금액은 최종 결제화면에서 확인가능합니다.)<br/>- 본 요금제는 CGV할인쿠폰, 현대카드 M포인트 및 즉시할인 신용카드와 중복할인이<br/>&nbsp;적용되지 않습니다.")}null!=r&&alert(r)},set:function(){t={discCD:$.cgv.data.좌석가확보완료정보.가격다변화코드,discNM:$.cgv.data.좌석가확보완료정보.가격다변화명,discPer:$.cgv.data.좌석가확보완료정보.가격다변화할인율},a.params["추가할인결제수단코드"]=t.discCD,a.params["추가할인대상매수"]=$.cgv.data.좌석가확보완료정보.예매인원수,a.params["추가할인율"]=t.discCD},cancel:u,apply:p,calc:function(e){var t=0;return n&&(t=parseInt(e*(s["가격다변화할인율"]/100),10),p(t=parseInt(100*Math.ceil(t/100),10))),t},isPosibleFn:function(){var e=!0;m=[];for(var t=0;t<TS3_PAYMENT_DATA.length;++t){var a=TS3_PAYMENT_DATA[t];$.each(f,function(e,t){a.code===e&&m.push(a)})}return 1<=m.length&&(e=!1),e},doNotUseChk:function(e){for(var t="",a=0;a<m.length;++a)t+=m[a].title,a<m.length-1&&(t+=" , ");var s="";o?(s="["+t+"]은 "+c.tit+"와 중복적용이 불가능 합니다.\n["+t+"] 적용을 취소하고\n"+c.tit+"을 사용하시겠습니까?",IS_ENGLISH&&(s="The <"+c.tit+">is invalid with other ["+t+"]\nThe <"+c.tit+">is automatically canceled if a ["+t+"] is applied.\n\nWould you like to continue using the <"+c.tit+">?")):(s="["+t+"]은 "+c.tit+"와 중복적용이 불가능 합니다.\n"+c.tit+" 적용을 취소하고\n["+t+"]을 사용하시겠습니까?",IS_ENGLISH&&(s="The <"+c.tit+">is invalid with other ["+t+"]\nThe <"+c.tit+">is automatically canceled if a ["+t+"] is applied.\n\nWould you like to continue using the ["+t+"]?"));var i=confirm(s);function n(e){for(var t=e.length,a=!0,s=0;s<e.length;++s)s===t-1&&(a=!1),ts3RemovePaymentDataByCode(e[s].code,a)}o?i?n(m):u():i?u():n(m),e()}}}();function isPremiumTheater(){var e=!1;return"0306"===userSelect_info.극장.극장코드&&("010"!==userSelect_info.상영관시간.상영관코드&&"011"!==userSelect_info.상영관시간.상영관코드&&"012"!==userSelect_info.상영관시간.상영관코드||(e=!0)),e}